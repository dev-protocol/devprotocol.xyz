---
const response = await fetch(
  'https://api.rss2json.com/v1/api.json?rss_url=https://medium.com/feed/devprtcl'
)
const data = await response.json()
const blogsData = data.items

const fetchedBlogs = blogsData.slice(0, 3)

const blogs = fetchedBlogs.map((blog: { description: string; desc: string }) => {
  const fetchedDescription = blog.description
  const slicedDescription = fetchedDescription.replace(/<[^>]+>/g, '').replace(/\n/g, '')

  blog.desc = slicedDescription.substring(0, 100) + '...'

  return blog
})
---

<section
  class="bg-blue-500 h-auto px-10 lg:px-20 py-28 text-white flex flex-col"
>
  <h3 class="text-4xl font-bold text-gray-100">Latest on Medium</h3>
  <main class="flex flex-col lg:flex-row">
    {
      blogs.map((blog) => (
        <div class="mr-8 flex flex-col" style="flex-basis: 100%">
          <a href={blog.link} class="text-white no-underline">
            <img src={blog.thumbnail} class="my-8 max-w-full pt-4" />
            <h3 class="pb-6  text-xl font-bold">{blog.title}</h3>
          </a>
          <p class="mb-3 text-left font-normal text-gray-100">
            {blog.desc}
            <a href={blog.link} class="ml-1 underline">
              Read more.
            </a>
          </p>
        </div>
      ))
    }
  </main>
  <p align="center">
    <a href="https://medium.com/devprtcl" class="mt-6 block">
      <button class="bg-white text-gray-900 py-2 px-6">
        See more on Medium
      </button>
    </a>
  </p>
</section>
